<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì§€ì›ì†ŒëŒ€ ì—´ì™¸ì¡°ì‚¬</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    label {
      display: block;
      margin: 8px 0;
    }
    .result {
      margin-top: 30px;
    }
    .squad-group {
      margin-bottom: 20px;
      padding: 10px;
      border: 2px solid #ccc;
      background-color: #f9f9f9;
    }
    .squad-title {
      font-weight: bold;
      font-size: 18px;
      margin-bottom: 10px;
    }
    .entry {
      margin-bottom: 10px;
      border-bottom: 1px dashed #aaa;
      padding-bottom: 5px;
    }
    .reason-input {
      display: none;
      margin-left: 20px;
      margin-top: 5px;
    }
    #summary {
      margin-top: 30px;
      padding: 15px;
      border: 2px solid #666;
      background-color: #eef;
      max-width: 300px;
    }
    #dateTitle {
      font-size: 22px;
      font-weight: bold;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <!-- ë‚ ì§œ í‘œì‹œ -->
  <div id="dateTitle">ì§€ì›ì†ŒëŒ€ ì—´ì™¸ì¡°ì‚¬ - ë‚ ì§œ: </div>

  <form id="infoForm">
    <label>
      ì´ë¦„:
      <input type="text" id="name" name="name" required />
    </label>

    <p>ë¶„ëŒ€ë¥¼ ì„ íƒí•˜ì„¸ìš”:</p>
    <label><input type="checkbox" name="squad" value="ì°¨ëŸ‰" /> ì°¨ëŸ‰</label>
    <label><input type="checkbox" name="squad" value="ì¥ë¹„" /> ì¥ë¹„</label>

    <p>ì—´ì™¸ ë‚´ìš©ì„ ì²´í¬í•´ì£¼ì„¸ìš”:</p>
    <label>
      <input type="checkbox" name="checks" value="ì•„ì¹¨ ì í˜¸ ì—´ì™¸" id="morningCheck" />
      ì•„ì¹¨ ì í˜¸ ì—´ì™¸
    </label>
    <input
      type="text"
      id="morningReason"
      class="reason-input"
      placeholder="ì—´ì™¸ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
    />

    <label>
      <input type="checkbox" name="checks" value="ì¼ê³¼ ì—´ì™¸" id="dayCheck" />
      ì¼ê³¼ ì—´ì™¸
    </label>
    <input
      type="text"
      id="dayReason"
      class="reason-input"
      placeholder="ì—´ì™¸ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
    />

    <label>
      <input type="checkbox" name="checks" value="ì—´ì™¸ì‚¬í•­ ì—†ìŒ" id="noCheck" />
      ì—´ì™¸ì‚¬í•­ ì—†ìŒ
    </label>

    <br /><br />
    <button type="submit">ì œì¶œ</button>
  </form>

  <div class="result" id="result">
    <h3>ë¶„ëŒ€ë³„ ì…ë ¥ ì •ë³´</h3>

    <div id="squad-ì°¨ëŸ‰" class="squad-group">
      <div class="squad-title">ğŸš™ ì°¨ëŸ‰ ë¶„ëŒ€</div>
    </div>

    <div id="squad-ì¥ë¹„" class="squad-group">
      <div class="squad-title">ğŸ”§ ì¥ë¹„ ë¶„ëŒ€</div>
    </div>
  </div>

  <div id="summary">
    <h3>ì—´ì™¸ í†µê³„</h3>
    <p>ì•„ì¹¨ ì í˜¸ ì—´ì™¸ ìˆ˜: <span id="morningCount">0</span></p>
    <p>ì¼ê³¼ ì—´ì™¸ ìˆ˜: <span id="dayCount">0</span></p>
  </div>

  <script>
    // í•œêµ­ì‹œê°„ ê¸°ì¤€ ì˜¤ëŠ˜ ë‚ ì§œ ë¬¸ìì—´ êµ¬í•˜ëŠ” í•¨ìˆ˜ (ì˜ˆ: 2025ë…„ 09ì›” 27ì¼)
    function getKoreanDateString() {
      const now = new Date();
      const utc = now.getTime() + now.getTimezoneOffset() * 60000;
      const kst = new Date(utc + 9 * 60 * 60000);

      const year = kst.getFullYear();
      const month = String(kst.getMonth() + 1).padStart(2, "0");
      const day = String(kst.getDate()).padStart(2, "0");

      return `${year}ë…„ ${month}ì›” ${day}ì¼`;
    }

    const dateTitle = document.getElementById("dateTitle");
    let todayDate = getKoreanDateString();
    dateTitle.textContent = `${todayDate} ì—´ì™¸ì¡°ì‚¬`;

    const form = document.getElementById("infoForm");

    const squadCheckboxes = document.querySelectorAll('input[name="squad"]');

    const morningCheck = document.getElementById("morningCheck");
    const dayCheck = document.getElementById("dayCheck");
    const noCheck = document.getElementById("noCheck");

    const morningReason = document.getElementById("morningReason");
    const dayReason = document.getElementById("dayReason");

    // í†µê³„ ë³€ìˆ˜
    let morningCount = 0;
    let dayCount = 0;

    // í†µê³„ ìš”ì†Œ
    const morningCountSpan = document.getElementById("morningCount");
    const dayCountSpan = document.getElementById("dayCount");

    // ë¶„ëŒ€ ì²´í¬ë°•ìŠ¤ ë¼ë””ì˜¤ì²˜ëŸ¼ ì‘ë™
    squadCheckboxes.forEach((cb) => {
      cb.addEventListener("change", function () {
        if (this.checked) {
          squadCheckboxes.forEach((other) => {
            if (other !== this) other.checked = false;
          });
        }
      });
    });

    // ì—´ì™¸ ì²´í¬ë°•ìŠ¤ & ì´ìœ  ì…ë ¥ì°½ í† ê¸€
    morningCheck.addEventListener("change", function () {
      morningReason.style.display = this.checked ? "block" : "none";
      if (!this.checked) morningReason.value = "";
      if (this.checked) {
        noCheck.checked = false;
        noCheck.disabled = false;
      }
    });

    dayCheck.addEventListener("change", function () {
      dayReason.style.display = this.checked ? "block" : "none";
      if (!this.checked) dayReason.value = "";
      if (this.checked) {
        noCheck.checked = false;
        noCheck.disabled = false;
      }
    });

    noCheck.addEventListener("change", function () {
      if (this.checked) {
        [morningCheck, dayCheck].forEach((cb) => {
          cb.checked = false;
          cb.disabled = true;
        });
        morningReason.style.display = "none";
        morningReason.value = "";
        dayReason.style.display = "none";
        dayReason.value = "";
      } else {
        [morningCheck, dayCheck].forEach((cb) => (cb.disabled = false));
      }
    });

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      // ë‚ ì§œê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸
      const currentDate = getKoreanDateString();
      if (currentDate !== todayDate) {
        // ë‚ ì§œ ë³€ê²½ì‹œ ë°ì´í„° ì´ˆê¸°í™”
        resetData();
        todayDate = currentDate;
        dateTitle.textContent = `${todayDate} ì—´ì™¸ì¡°ì‚¬`;
      }

      const name = document.getElementById("name").value.trim();
      const selectedSquad = document.querySelector('input[name="squad"]:checked');
      const squad = selectedSquad ? selectedSquad.value : null;

      if (!name || !squad) {
        alert("ì´ë¦„ê³¼ ë¶„ëŒ€ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }

      const checkedBoxes = document.querySelectorAll('input[name="checks"]:checked');
      if (checkedBoxes.length === 0) {
        alert("ì—´ì™¸ ë‚´ìš©ì„ í•œ ê°œ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.");
        return;
      }

      let detailList = [];
      if (noCheck.checked) {
        detailList = ["ì—´ì™¸ì‚¬í•­ ì—†ìŒ"];
      } else {
        if (morningCheck.checked) {
          const reason = morningReason.value.trim() || "ì‚¬ìœ  ì—†ìŒ";
          detailList.push(`ì•„ì¹¨ ì í˜¸ ì—´ì™¸ (${reason})`);
          morningCount++;
        }
        if (dayCheck.checked) {
          const reason = dayReason.value.trim() || "ì‚¬ìœ  ì—†ìŒ";
          detailList.push(`ì¼ê³¼ ì—´ì™¸ (${reason})`);
          dayCount++;
        }
      }

      // ê²°ê³¼ ì¶œë ¥
      const entryDiv = document.createElement("div");
      entryDiv.className = "entry";
      entryDiv.innerHTML = `
        <strong>ì´ë¦„:</strong> ${name}<br>
        <strong>ì—´ì™¸ ë‚´ìš©:</strong> ${detailList.join(", ")}
      `;

      const squadContainer = document.getElementById("squad-" + squad);
      if (squadContainer) {
        squadContainer.appendChild(entryDiv);
      } else {
        alert("ë¶„ëŒ€ ì¶œë ¥ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
      }

      // í†µê³„ ì—…ë°ì´íŠ¸
      morningCountSpan.textContent = morningCount;
      dayCountSpan.textContent = dayCount;

      form.reset();

      // ì´ìœ  ì…ë ¥ì°½ ìˆ¨ê¸°ê¸° ì´ˆê¸°í™”
      morningReason.style.display = "none";
      dayReason.style.display = "none";

      // ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì´ˆê¸°í™” - ë¶„ëŒ€
      squadCheckboxes.forEach((cb) => {
        cb.checked = false;
        cb.disabled = false;
      });

      // ì—´ì™¸ì‚¬í•­ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì´ˆê¸°í™”
      [morningCheck, dayCheck, noCheck].forEach((cb) => {
        cb.checked = false;
        cb.disabled = false;
      });

      morningReason.value = "";
      dayReason.value = "";
    });

    // ë°ì´í„° ì´ˆê¸°í™” í•¨ìˆ˜
    function resetData() {
      morningCount = 0;
      dayCount = 0;
      morningCountSpan.textContent = "0";
      dayCountSpan.textContent = "0";

      // ë¶„ëŒ€ë³„ ì…ë ¥ ì •ë³´ ì´ˆê¸°í™”
      const vehicleSquad = document.getElementById("squad-ì°¨ëŸ‰");
      const equipmentSquad = document.getElementById("squad-ì¥ë¹„");

      // .entryë§Œ ì‚­ì œ (ë¶„ëŒ€ íƒ€ì´í‹€ì€ ë‚¨ê¹€)
      Array.from(vehicleSquad.querySelectorAll(".entry")).forEach((el) => el.remove());
      Array.from(equipmentSquad.querySelectorAll(".entry")).forEach((el) => el.remove());
    }

    // í˜ì´ì§€ ë¡œë“œ í›„ 1ë¶„ë§ˆë‹¤ ë‚ ì§œ ì²´í¬í•´ì„œ ë°”ë€Œë©´ ì´ˆê¸°í™”
    setInterval(() => {
      const currentDate = getKoreanDateString();
      if (currentDate !== todayDate) {
        resetData();
        todayDate = currentDate;
        dateTitle.textContent = `${todayDate} ì—´ì™¸ì¡°ì‚¬`;
      }
    }, 600000); // 60000ms = 1ë¶„
  </script>
</body>
</html>






